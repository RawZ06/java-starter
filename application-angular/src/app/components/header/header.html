<header class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50 shadow-sm transition-colors">
  <div class="max-w-screen-xl mx-auto px-6 py-4 flex justify-end items-center">
    <nav class="flex items-center gap-4">
      <!-- Theme Selector -->
      <div class="relative">
        <button class="inline-flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors cursor-pointer" (click)="toggleThemeDropdown()">
          <i [class]="themeService.getThemeIcon(themeService.themeMode())"></i>
        </button>

        @if (themeDropdownOpen()) {
          <div class="absolute right-0 top-full mt-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg min-w-[160px] py-2 z-[100]">
            @for (theme of themeService.getAvailableThemes(); track theme.mode) {
              <button
                class="flex items-center gap-3 w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                [class.bg-blue-50]="themeService.themeMode() === theme.mode"
                [class.dark:bg-blue-900]="themeService.themeMode() === theme.mode"
                (click)="selectTheme(theme.mode)">
                <i [class]="theme.icon"></i>
                <span>{{ theme.label | translate }}</span>
              </button>
            }
          </div>
        }
      </div>

      <!-- Language Selector -->
      <div class="relative">
        <button class="inline-flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors cursor-pointer" (click)="toggleLangDropdown()">
          <i class="fas fa-globe text-gray-700 dark:text-gray-200"></i>
          <span class="text-sm font-medium text-gray-700 dark:text-gray-200">{{ languageService.currentLang() === 'fr' ? 'ðŸ‡«ðŸ‡·' : 'ðŸ‡¬ðŸ‡§' }}</span>
        </button>

        @if (langDropdownOpen()) {
          <div class="absolute right-0 top-full mt-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg min-w-[160px] py-2 z-[100]">
            @for (lang of languageService.getAvailableLanguages(); track lang.code) {
              <button
                class="flex items-center gap-3 w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
                [class.bg-blue-50]="languageService.currentLang() === lang.code"
                [class.dark:bg-blue-900]="languageService.currentLang() === lang.code"
                (click)="selectLanguage(lang.code)">
                <span class="text-lg">{{ lang.flag }}</span>
                <span>{{ lang.label }}</span>
              </button>
            }
          </div>
        }
      </div>

      @if (!authService.token()) {
        <a routerLink="/login" class="inline-flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-md font-medium hover:bg-blue-600 transition-colors">
          <i class="fas fa-sign-in-alt"></i>
          {{ 'header.login' | translate }}
        </a>
      } @else {
        <div class="relative">
          <button class="inline-flex items-center gap-2 px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors cursor-pointer" (click)="toggleDropdown()">
            <i class="fas fa-user text-gray-700 dark:text-gray-200"></i>
            @if (authService.currentUser()) {
              <span class="text-sm font-medium text-gray-700 dark:text-gray-200">{{ authService.currentUser()!.login }}</span>
            }
            <i class="fas fa-chevron-down text-xs text-gray-700 dark:text-gray-200"></i>
          </button>

          @if (dropdownOpen()) {
            <div class="absolute right-0 top-full mt-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg min-w-[220px] py-2 z-[100]">
              @if (authService.currentUser()) {
                <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                  <div class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ authService.currentUser()!.login }}</div>
                  @if (authService.currentUser()!.email) {
                    <div class="text-xs text-gray-500 dark:text-gray-400 mt-1">{{ authService.currentUser()!.email }}</div>
                  }
                  <div class="text-xs text-gray-400 dark:text-gray-500 mt-1">
                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium"
                          [class.bg-purple-100]="authService.currentUser()!.role === 'ADMIN'"
                          [class.text-purple-800]="authService.currentUser()!.role === 'ADMIN'"
                          [class.dark:bg-purple-900]="authService.currentUser()!.role === 'ADMIN'"
                          [class.dark:text-purple-200]="authService.currentUser()!.role === 'ADMIN'"
                          [class.bg-gray-100]="authService.currentUser()!.role === 'USER'"
                          [class.text-gray-800]="authService.currentUser()!.role === 'USER'"
                          [class.dark:bg-gray-700]="authService.currentUser()!.role === 'USER'"
                          [class.dark:text-gray-300]="authService.currentUser()!.role === 'USER'">
                      {{ authService.currentUser()!.role }}
                    </span>
                  </div>
                </div>
              }
              @if (authService.currentUser()?.role === 'ADMIN') {
                <a routerLink="/dashboard" class="flex items-center gap-3 w-full px-4 py-3 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" (click)="dropdownOpen.set(false)">
                  <i class="fas fa-th w-[18px] text-center"></i>
                  {{ 'header.dashboard' | translate }}
                </a>
              }
              <a routerLink="/profile" class="flex items-center gap-3 w-full px-4 py-3 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" (click)="dropdownOpen.set(false)">
                <i class="fas fa-cog w-[18px] text-center"></i>
                {{ 'header.settings' | translate }}
              </a>
              <button class="flex items-center gap-3 w-full px-4 py-3 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" (click)="logout()">
                <i class="fas fa-sign-out-alt w-[18px] text-center"></i>
                {{ 'header.logout' | translate }}
              </button>
            </div>
          }
        </div>
      }
    </nav>
  </div>
</header>
