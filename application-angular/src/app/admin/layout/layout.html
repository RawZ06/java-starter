<div class="flex h-screen overflow-hidden">
  <!-- Sidebar -->
  <aside [class]="sidebarOpen() ? 'w-64' : 'w-[70px]'" class="bg-gray-800 text-white flex flex-col transition-all duration-300 flex-shrink-0">
    <div class="p-6 border-b border-white/10">
      <div class="text-xl font-semibold text-center">
        @if (sidebarOpen()) {
          <span>{{ 'admin.adminPanel' | translate }}</span>
        } @else {
          <span class="text-2xl font-bold">A</span>
        }
      </div>
    </div>

    <nav class="flex-1 py-4 overflow-y-auto">
      <a routerLink="/dashboard" routerLinkActive="!bg-blue-500/30 !text-white !border-l-blue-500" [class]="sidebarOpen() ? 'flex items-center gap-3 px-6 py-3 text-gray-300 hover:bg-white/10 hover:text-white transition-all border-l-3 border-transparent' : 'flex items-center justify-center px-0 py-3 text-gray-300 hover:bg-white/10 hover:text-white transition-all border-l-3 border-transparent'">
        <i class="fas fa-th w-5 text-center"></i>
        @if (sidebarOpen()) {
          <span class="text-sm">{{ 'admin.dashboard' | translate }}</span>
        }
      </a>

      <a routerLink="/admin/users" routerLinkActive="!bg-blue-500/30 !text-white !border-l-blue-500" [class]="sidebarOpen() ? 'flex items-center gap-3 px-6 py-3 text-gray-300 hover:bg-white/10 hover:text-white transition-all border-l-3 border-transparent' : 'flex items-center justify-center px-0 py-3 text-gray-300 hover:bg-white/10 hover:text-white transition-all border-l-3 border-transparent'">
        <i class="fas fa-users w-5 text-center"></i>
        @if (sidebarOpen()) {
          <span class="text-sm">{{ 'admin.users' | translate }}</span>
        }
      </a>

      <a routerLink="/admin/settings" routerLinkActive="!bg-blue-500/30 !text-white !border-l-blue-500" [class]="sidebarOpen() ? 'flex items-center gap-3 px-6 py-3 text-gray-300 hover:bg-white/10 hover:text-white transition-all border-l-3 border-transparent' : 'flex items-center justify-center px-0 py-3 text-gray-300 hover:bg-white/10 hover:text-white transition-all border-l-3 border-transparent'">
        <i class="fas fa-cog w-5 text-center"></i>
        @if (sidebarOpen()) {
          <span class="text-sm">{{ 'admin.settings' | translate }}</span>
        }
      </a>
    </nav>

    <div class="py-4 border-t border-white/10">
      <a routerLink="/" [class]="sidebarOpen() ? 'flex items-center gap-3 px-6 py-3 text-gray-300 hover:bg-white/10 hover:text-white transition-all' : 'flex items-center justify-center px-0 py-3 text-gray-300 hover:bg-white/10 hover:text-white transition-all'">
        <i class="fas fa-home w-5 text-center"></i>
        @if (sidebarOpen()) {
          <span class="text-sm">{{ 'admin.backToSite' | translate }}</span>
        }
      </a>
    </div>
  </aside>

  <!-- Main Content -->
  <div class="flex-1 flex flex-col overflow-hidden bg-gray-50">
    <!-- Top Header -->
    <header class="h-[60px] bg-white border-b border-gray-200 flex items-center justify-between px-6 flex-shrink-0">
      <button class="p-2 hover:bg-gray-100 rounded-md transition-colors" (click)="toggleSidebar()">
        <i class="fas fa-bars"></i>
      </button>

      <div class="flex items-center gap-4">
        <!-- Language Selector -->
        <div class="relative">
          <button class="flex items-center gap-2 px-3 py-2 hover:bg-gray-100 rounded-md transition-colors cursor-pointer" (click)="toggleLangDropdown()">
            <i class="fas fa-globe"></i>
            <span class="text-sm font-medium">{{ languageService.currentLang() === 'fr' ? 'ðŸ‡«ðŸ‡·' : 'ðŸ‡¬ðŸ‡§' }}</span>
          </button>

          @if (langDropdownOpen()) {
            <div class="absolute right-0 top-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg min-w-[160px] py-2 z-[100]">
              @for (lang of languageService.getAvailableLanguages(); track lang.code) {
                <button
                  class="flex items-center gap-3 w-full px-4 py-2 text-left text-sm hover:bg-gray-100 transition-colors"
                  [class.bg-blue-50]="languageService.currentLang() === lang.code"
                  (click)="selectLanguage(lang.code)">
                  <span class="text-lg">{{ lang.flag }}</span>
                  <span>{{ lang.label }}</span>
                </button>
              }
            </div>
          }
        </div>

        <!-- User Menu -->
        <div class="relative">
          <button class="flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors cursor-pointer" (click)="toggleDropdown()">
            <i class="fas fa-user"></i>
            @if (authService.currentUser()) {
              <span class="text-sm font-medium">{{ authService.currentUser()!.login }}</span>
            }
            <i class="fas fa-chevron-down text-xs"></i>
          </button>

          @if (dropdownOpen()) {
            <div class="absolute right-0 top-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg min-w-[220px] py-2 z-[100]">
              @if (authService.currentUser()) {
                <div class="px-4 py-3 border-b border-gray-200">
                  <div class="text-sm font-medium text-gray-900">{{ authService.currentUser()!.login }}</div>
                  @if (authService.currentUser()!.email) {
                    <div class="text-xs text-gray-500 mt-1">{{ authService.currentUser()!.email }}</div>
                  }
                  <div class="text-xs text-gray-400 mt-1">
                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium"
                          [class.bg-purple-100]="authService.currentUser()!.role === 'ADMIN'"
                          [class.text-purple-800]="authService.currentUser()!.role === 'ADMIN'"
                          [class.bg-gray-100]="authService.currentUser()!.role === 'USER'"
                          [class.text-gray-800]="authService.currentUser()!.role === 'USER'">
                      {{ authService.currentUser()!.role }}
                    </span>
                  </div>
                </div>
              }
              <a routerLink="/profile" class="flex items-center gap-3 w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-100 transition-colors" (click)="dropdownOpen.set(false)">
                <i class="fas fa-user-circle w-[18px] text-center"></i>
                {{ 'admin.profile' | translate }}
              </a>
              <button class="flex items-center gap-3 w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-100 transition-colors" (click)="logout()">
                <i class="fas fa-sign-out-alt w-[18px] text-center"></i>
                {{ 'admin.logout' | translate }}
              </button>
            </div>
          }
        </div>
      </div>
    </header>

    <!-- Page Content -->
    <main class="flex-1 overflow-y-auto p-8">
      <router-outlet></router-outlet>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 py-4 px-6 flex-shrink-0">
      <div class="flex flex-col md:flex-row justify-between items-center gap-2 text-sm text-gray-600">
        <div>
          Â© {{ currentYear }} <span class="font-semibold text-gray-900">RawZ06</span>. {{ 'footer.copyright' | translate }}
        </div>
        <div class="flex gap-4">
          <a href="#" class="hover:text-gray-900 transition-colors">{{ 'footer.privacy' | translate }}</a>
          <a href="#" class="hover:text-gray-900 transition-colors">{{ 'footer.terms' | translate }}</a>
          <a href="https://github.com" class="hover:text-gray-900 transition-colors">
            <i class="fab fa-github mr-1"></i>
            {{ 'footer.github' | translate }}
          </a>
        </div>
      </div>
    </footer>
  </div>
</div>
